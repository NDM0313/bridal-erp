<!DOCTYPE html>
<html>
<head>
    <title>Registration Form Debug</title>
    <style>
        body { font-family: Arial; margin: 20px; background: #f5f5f5; }
        .container { background: white; padding: 20px; border-radius: 5px; max-width: 600px; margin: 0 auto; }
        h2 { color: #333; }
        .info { background: #e3f2fd; padding: 10px; margin: 10px 0; border-left: 4px solid #2196F3; }
        .error { background: #ffebee; padding: 10px; margin: 10px 0; border-left: 4px solid #f44336; }
        .success { background: #e8f5e9; padding: 10px; margin: 10px 0; border-left: 4px solid #4caf50; }
        code { background: #f4f4f4; padding: 2px 6px; border-radius: 3px; }
        textarea { width: 100%; height: 300px; font-family: monospace; padding: 10px; border: 1px solid #ddd; }
        button { padding: 10px 20px; background: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #1976D2; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Registration Form Debugging</h2>
        
        <div class="info">
            <strong>To diagnose the issue:</strong><br>
            1. Open this page in a new tab<br>
            2. Open DevTools (F12)<br>
            3. Go to Console tab<br>
            4. Copy all console output<br>
            5. Paste it below and submit
        </div>

        <h3>Step 1: Check Form Status</h3>
        <button onclick="checkFormStatus()">Check Form Status</button>
        <textarea id="status-output" placeholder="Output will appear here..."></textarea>

        <h3>Step 2: Check Validation Rules</h3>
        <button onclick="checkValidationRules()">Check Validation Rules</button>
        <textarea id="rules-output" placeholder="Validation rules will appear here..."></textarea>

        <h3>Step 3: Simulate Form Submit</h3>
        <button onclick="testFormSubmit()">Test Form Submit Locally</button>
        <textarea id="submit-output" placeholder="Submit test output will appear here..."></textarea>

        <h3>Step 4: Navigate to Registration</h3>
        <button onclick="goToRegistration()">Go to Registration Form</button>

        <p style="margin-top: 30px; color: #999; font-size: 12px;">
            After clicking "Go to Registration Form", please:<br>
            1. Fill all fields as shown in the earlier instructions<br>
            2. When you click Register, immediately come back to this page and click "Check Console Output"<br>
            3. Share the output with me
        </p>
    </div>

    <script>
        function checkFormStatus() {
            let output = "=== FORM STATUS CHECK ===\n\n";
            
            // Check if jQuery is loaded
            if (typeof jQuery !== 'undefined') {
                output += "✓ jQuery is loaded\n";
            } else {
                output += "✗ jQuery is NOT loaded\n";
            }

            // Check if jQuery Steps is available
            if (typeof jQuery !== 'undefined' && jQuery.fn.steps) {
                output += "✓ jQuery Steps plugin is loaded\n";
            } else {
                output += "✗ jQuery Steps plugin is NOT loaded\n";
            }

            // Check if form exists
            const form = document.getElementById('business_register_form');
            if (form) {
                output += "✓ Form element #business_register_form exists\n";
                output += "  - Form action: " + form.action + "\n";
                output += "  - Form method: " + form.method + "\n";
                output += "  - Form fields count: " + form.elements.length + "\n";
            } else {
                output += "✗ Form element NOT found\n";
            }

            output += "\n=== BROWSER INFO ===\n";
            output += "User Agent: " + navigator.userAgent + "\n";
            output += "Current URL: " + window.location.href + "\n";

            document.getElementById('status-output').value = output;
        }

        function checkValidationRules() {
            let output = "=== VALIDATION RULES CHECK ===\n\n";
            
            if (typeof jQuery !== 'undefined') {
                const form = jQuery('#business_register_form');
                if (form.length) {
                    const settings = form.validate().settings;
                    output += "Form Validation Settings:\n";
                    output += JSON.stringify(settings, null, 2) + "\n\n";
                    output += "Rules:\n";
                    output += JSON.stringify(settings.rules, null, 2) + "\n";
                } else {
                    output += "Form not found";
                }
            } else {
                output += "jQuery not available";
            }

            document.getElementById('rules-output').value = output;
        }

        function testFormSubmit() {
            let output = "=== FORM SUBMIT TEST ===\n\n";
            
            const form = document.getElementById('business_register_form');
            if (!form) {
                output += "✗ Form not found\n";
            } else {
                output += "✓ Form found\n";
                output += "Form action: " + form.action + "\n";
                output += "Form method: " + form.method.toUpperCase() + "\n";
                output += "CSRF token present: " + (form.querySelector('input[name="_token"]') ? 'Yes' : 'No') + "\n\n";
                
                output += "Form Fields:\n";
                for (let i = 0; i < form.elements.length; i++) {
                    const elem = form.elements[i];
                    if (elem.name) {
                        output += "- " + elem.name + " = " + (elem.type === 'password' ? '[hidden]' : elem.value) + "\n";
                    }
                }
                
                output += "\n✓ Form is ready to submit\n";
                output += "✓ To submit, the form will POST to: " + form.action + "\n";
            }

            document.getElementById('submit-output').value = output;
        }

        function goToRegistration() {
            window.location.href = '/business/register';
        }

        // Auto-check on load
        window.addEventListener('load', function() {
            checkFormStatus();
        });
    </script>
</body>
</html>
